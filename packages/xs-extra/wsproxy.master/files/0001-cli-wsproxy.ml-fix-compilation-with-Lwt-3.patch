From ddb5a0f6d0ef703f9dcc379663ba87d94acc4e6b Mon Sep 17 00:00:00 2001
From: Gabor Igloi <gabor.igloi@citrix.com>
Date: Fri, 20 Oct 2017 15:30:33 +0100
Subject: [PATCH] cli/wsproxy.ml: fix compilation with Lwt 3

Bind now returns a promise.

Signed-off-by: Marcello Seri <marcello.seri@citrix.com>
---
 cli/wsproxy.ml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/cli/wsproxy.ml b/cli/wsproxy.ml
index 6d12575..d7d4631 100644
--- a/cli/wsproxy.ml
+++ b/cli/wsproxy.ml
@@ -28,7 +28,7 @@ let start path handler =
   Lwt.catch
     (fun () -> Lwt_unix.unlink fd_sock_path)
     (fun _ -> Lwt.return_unit) >>= fun () ->
-  let () = Lwt_unix.bind fd_sock (Unix.ADDR_UNIX fd_sock_path) in
+  Lwt_unix.bind fd_sock (Unix.ADDR_UNIX fd_sock_path) >>= fun () ->
   let () = Lwt_unix.listen fd_sock 5 in
 
   let rec loop () =
-- 
2.11.0

