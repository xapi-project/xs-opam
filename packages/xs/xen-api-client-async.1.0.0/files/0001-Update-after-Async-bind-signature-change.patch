From 54e39e91f296573b75e0e0360b06fd5a7702e76a Mon Sep 17 00:00:00 2001
From: Gabor Igloi <gabor.igloi@citrix.com>
Date: Thu, 19 Oct 2017 16:00:05 +0100
Subject: [PATCH] Update after Async bind signature change

Signed-off-by: Gabor Igloi <gabor.igloi@citrix.com>
---
 async/xen_api_async_unix.ml  | 2 +-
 async/xen_api_async_unix.mli | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/async/xen_api_async_unix.ml b/async/xen_api_async_unix.ml
index 57110a4..898ed03 100644
--- a/async/xen_api_async_unix.ml
+++ b/async/xen_api_async_unix.ml
@@ -119,5 +119,5 @@ let make_json ?(timeout=30.) uri call =
   do_it uri req >>| Jsonrpc.response_of_string
 
 
-module Client = Client.ClientF(Deferred)
+module Client = Client.ClientF(struct include Deferred let bind a f = bind a ~f end)
 include Client
diff --git a/async/xen_api_async_unix.mli b/async/xen_api_async_unix.mli
index e565066..7845c04 100644
--- a/async/xen_api_async_unix.mli
+++ b/async/xen_api_async_unix.mli
@@ -20,4 +20,4 @@ val make_json: ?timeout:float -> string -> Rpc.call -> Rpc.response Async.Std.De
 (** [make_json ?timeout uri] returns an 'rpc' function which can be
     passed to Client.* functions *)
 
-include (module type of (Client.ClientF(Async.Std.Deferred)))
+include (module type of (Client.ClientF(struct include Async.Std.Deferred let bind a f = bind a ~f end)))
-- 
2.7.4

